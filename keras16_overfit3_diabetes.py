
from sklearn.datasets import load_diabetes
from tensorflow.python.keras.models import Sequential
from tensorflow.python.keras.layers import Dense, Dropout
from sklearn.model_selection import train_test_split
import matplotlib.pyplot as plt

datasets = load_diabetes()

x = datasets.data
y = datasets.target

print('\n', x.shape, y.shape, '\n')    

x_train, x_test, y_train, y_test = train_test_split(x, y, train_size=0.7, random_state=20580)


model = Sequential()
model.add(Dense(64, input_dim=10, activation='relu'))
model.add(Dropout(0.2))
model.add(Dense(32, activation='relu'))
model.add(Dropout(0.2))
model.add(Dense(16, activation='relu'))
model.add(Dense(1))


model.compile(loss='mse', optimizer='adam')
hist = model.fit(x_train, y_train, epochs=200, batch_size=10, validation_split=0.2, verbose=0)

print(hist.history)

plt.plot(hist.history['loss'])
plt.show()



################  < 작업 결과 >  ##################


[Running] python -u "c:\Users\sea bongja\OneDrive\바탕 화면\study\keras16_overfit3_diabetes.py"

 (442, 10) (442,) 

2023-03-28 14:04:13.474168: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library ...
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
{'loss': [28766.09375, 28648.74609375, 28261.41015625, 27205.900390625, 24722.23046875, 20049.9921875, 13700.673828125, 7743.8798828125, 5536.0029296875, 
         5150.83154296875, 5225.15673828125, 5123.37109375, 4941.31884765625, 4765.18896484375, 4512.853515625, 4598.36279296875, 4857.50244140625, 4660.900390625, 
         4507.6826171875, 4637.2216796875, 4394.58056640625, 4250.64111328125, 4494.25390625, 4360.8173828125, 4513.5419921875, 4145.23046875, 4172.36279296875, 
         3986.317626953125, 4247.79541015625, 4131.37060546875, 3623.591796875, 4363.8095703125, 4278.15087890625, 4081.286865234375, 3827.844970703125, 
         4008.41455078125, 3924.093017578125, 4048.87548828125, 3972.1865234375, 4072.945556640625, 4163.017578125, 4400.46044921875, 3955.0751953125, 
         3806.773193359375, 4050.720703125, 3994.6240234375, 3896.619384765625, 3668.372314453125, 3954.577392578125, 3969.61328125, 4095.7080078125, 
         3902.228515625, 3987.8017578125, 4256.13037109375, 3787.50244140625, 4018.74365234375, 3996.594482421875, 3774.320556640625, 4075.953857421875, 
         3876.06982421875, 4056.8642578125, 3935.335205078125, 3832.348876953125, 3969.518310546875, 3842.690185546875, 3805.342041015625, 3887.1533203125, 
         3939.961669921875, 3823.19384765625, 4132.3662109375, 3686.562744140625, 4028.231201171875, 3735.83251953125, 3740.325927734375, 3779.9482421875, 
         3791.239013671875, 4088.8447265625, 3739.52197265625, 3973.454345703125, 3791.34130859375, 3821.903076171875, 4039.39453125, 3887.921630859375, 
         3800.06640625, 3638.806640625, 3911.542236328125, 3958.94970703125, 3897.168701171875, 3986.848876953125, 3945.41845703125, 3821.862548828125, 
         3768.7294921875, 3684.967529296875, 3854.490478515625, 3919.529541015625, 3956.377685546875, 3891.91162109375, 3703.96630859375, 4010.9296875, 
         3839.554931640625, 3809.380126953125, 3865.4013671875, 3898.9208984375, 3952.8642578125, 3942.42578125, 3715.19384765625, 4005.0908203125, 3615.767578125, 
         3784.5, 3566.708984375, 4033.396484375, 3614.730224609375, 3954.42578125, 3957.281982421875, 3791.379638671875, 3826.360107421875, 3529.841064453125, 
         4093.78466796875, 3814.294921875, 3844.238037109375, 3900.78076171875, 3786.28955078125, 3687.310302734375, 3681.05517578125, 3761.656005859375, 
         3570.66162109375, 3816.655517578125, 3971.392822265625, 3790.389404296875, 3918.017822265625, 3978.509521484375, 4044.516357421875, 3906.83154296875, 
         3900.783447265625, 3724.74755859375, 3918.512451171875, 3808.291015625, 3559.5654296875, 4035.970458984375, 3896.569580078125, 4055.20703125, 
         3723.8291015625, 3863.61865234375, 3659.176513671875, 3887.25048828125, 3685.16455078125, 3901.81201171875, 3653.03173828125, 3758.5888671875, 
         3783.353271484375, 3865.314697265625, 3556.97412109375, 3780.919677734375, 3798.446533203125, 3667.14111328125, 3903.776611328125, 3749.2158203125, 
         3741.284912109375, 3654.388916015625, 3542.507568359375, 3794.027099609375, 3945.82568359375, 3599.062255859375, 3925.76708984375, 3703.3974609375, 
         3642.237060546875, 3941.853515625, 3759.899169921875, 3637.510986328125, 3810.546142578125, 3720.013427734375, 3814.447021484375, 3698.628173828125, 
         3882.20068359375, 3667.923095703125, 3991.167724609375, 4093.3447265625, 3415.497314453125, 3819.96728515625, 3641.689697265625, 3694.754638671875, 
         3704.7529296875, 3700.22021484375, 3740.9443359375, 3630.939453125, 3681.64599609375, 3983.805908203125, 3508.508544921875, 3676.716552734375, 
         3891.886962890625, 3655.797119140625, 3806.1904296875, 3762.04052734375, 3885.30322265625, 3889.476318359375, 3954.61865234375, 3940.49560546875, 
         3719.095458984375, 3895.078125, 3839.607177734375], 
 'val_loss': [28847.07421875, 28631.92578125, 27961.099609375, 26236.44140625, 22609.568359375, 16620.494140625, 9484.1591796875, 4859.28955078125, 4029.741943359375, 
             3823.325927734375, 3662.599609375, 3541.4794921875, 3420.630615234375, 3318.9638671875, 3216.1826171875, 3152.13720703125, 3062.439208984375, 
             3004.34814453125, 2935.753173828125, 2875.853759765625, 2824.91357421875, 2777.290771484375, 2770.2060546875, 2690.37353515625, 2663.817626953125, 
             2645.255126953125, 2608.0615234375, 2591.552490234375, 2577.870361328125, 2564.69091796875, 2548.6591796875, 2530.092041015625, 2536.075439453125, 
             2498.380615234375, 2494.776123046875, 2486.93017578125, 2474.814208984375, 2472.138916015625, 2470.103271484375, 2464.608642578125, 2449.18896484375, 
             2444.171142578125, 2450.84423828125, 2445.1533203125, 2435.015869140625, 2448.57861328125, 2457.286865234375, 2443.013671875, 2460.796142578125, 
             2439.061767578125, 2449.096435546875, 2439.222412109375, 2437.565673828125, 2442.47021484375, 2455.349609375, 2454.296875, 2445.4853515625, 
             2465.971435546875, 2464.708740234375, 2457.865966796875, 2473.01220703125, 2479.353759765625, 2467.490478515625, 2459.387451171875, 2472.417236328125, 
             2468.06298828125, 2495.967529296875, 2474.5458984375, 2482.098388671875, 2474.4580078125, 2486.769775390625, 2468.693115234375, 2480.585693359375, 
             2471.739501953125, 2468.744384765625, 2481.377685546875, 2496.53125, 2473.86376953125, 2475.544921875, 2481.946044921875, 2526.105224609375, 
             2483.818603515625, 2497.78369140625, 2491.6201171875, 2489.4794921875, 2511.411865234375, 2483.44091796875, 2517.2841796875, 2500.625, 2486.317138671875, 
             2497.578125, 2485.72900390625, 2544.95947265625, 2496.418212890625, 2507.1806640625, 2516.30419921875, 2506.682373046875, 2497.2666015625, 
             2513.596923828125, 2495.8154296875, 2522.0439453125, 2500.640380859375, 2540.10205078125, 2506.4345703125, 2516.203857421875, 2563.4423828125, 
             2507.781494140625, 2532.980224609375, 2507.547607421875, 2515.106689453125, 2521.6416015625, 2515.50634765625, 2507.880859375, 2535.544921875, 
             2537.473876953125, 2505.87255859375, 2499.7236328125, 2497.285400390625, 2501.16748046875, 2505.222412109375, 2512.555908203125, 2511.227783203125, 
             2514.39794921875, 2494.821533203125, 2516.03271484375, 2495.7587890625, 2524.843017578125, 2511.1142578125, 2558.290771484375, 2528.03076171875, 
             2510.2626953125, 2530.16357421875, 2515.6904296875, 2507.277099609375, 2509.032958984375, 2504.571533203125, 2531.3720703125, 2527.811279296875, 
             2525.4150390625, 2534.8037109375, 2510.40087890625, 2503.943359375, 2524.985107421875, 2499.81591796875, 2504.761474609375, 2543.178466796875, 
             2512.041015625, 2497.398193359375, 2515.020263671875, 2508.39208984375, 2531.17236328125, 2513.089599609375, 2516.453857421875, 2510.81005859375, 
             2518.530029296875, 2501.11767578125, 2503.093017578125, 2508.486572265625, 2508.88134765625, 2499.236572265625, 2499.869384765625, 2500.907470703125, 
             2493.068603515625, 2497.390380859375, 2497.537109375, 2492.7236328125, 2496.149169921875, 2497.194091796875, 2487.4619140625, 2487.591064453125, 
             2501.698486328125, 2504.378173828125, 2480.713134765625, 2473.26123046875, 2471.943115234375, 2480.2939453125, 2474.488525390625, 2522.649658203125, 
             2489.538330078125, 2483.338623046875, 2495.3349609375, 2507.6640625, 2504.753662109375, 2501.073974609375, 2514.4208984375, 2502.13720703125, 
             2508.17724609375, 2504.65869140625, 2482.936279296875, 2516.550537109375, 2491.67333984375, 2483.1923828125, 2491.93310546875, 2483.828857421875, 
             2494.4775390625, 2488.8759765625, 2501.369384765625, 2497.833251953125, 2490.45361328125, 2534.677001953125]}

[Done] exited with code=0 in 276.264 seconds

   
